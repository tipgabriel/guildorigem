<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guild Origem - AdventureQuest Worlds</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-base': '#171717',
                        'neon-green': '#39FF14',
                        'neon-green-hover': '#32E612',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #171717;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .neon-border {
            border: 2px solid #39FF14;
        }
        
        .neon-button {
            background-color: #39FF14;
            color: #171717;
            transition: all 0.3s ease;
        }
        
        .neon-button:hover {
            background-color: #32E612;
        }
        
        .member-card {
            background-color: #1f1f1f;
            transition: transform 0.3s ease;
        }
        
        .member-card:hover {
            transform: translateY(-5px);
        }
        
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .progress-bar {
            background-color: #2a2a2a;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            background-color: #39FF14;
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .user-panel {
            min-height: calc(100vh - 80px);
        }
        
        .hidden {
            display: none;
        }

        /* Bot√£o Google Transparente e Moderno */
        .google-login {
            background: transparent;
            color: #ffffff;
            border: 2px solid #4285F4;
            border-radius: 8px;
            padding: 12px 20px;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .google-login::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(66, 133, 244, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .google-login:hover::before {
            left: 100%;
        }

        .google-login:hover {
            background: rgba(66, 133, 244, 0.1);
            border-color: #5a95f5;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
        }

        .google-login:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(66, 133, 244, 0.2);
        }

        .google-icon {
            width: 18px;
            height: 18px;
            transition: transform 0.3s ease;
        }

        .google-login:hover .google-icon {
            transform: scale(1.1);
        }

        /* Loading Spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #39FF14;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background-color: #10B981;
            border-left: 4px solid #059669;
        }

        .toast.error {
            background-color: #EF4444;
            border-left: 4px solid #DC2626;
        }

        .toast.info {
            background-color: #3B82F6;
            border-left: 4px solid #2563EB;
        }

        /* Dropdown Menu */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: #1f1f1f;
            border: 1px solid #39FF14;
            border-radius: 8px;
            padding: 8px 0;
            min-width: 180px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .dropdown-item {
            display: block;
            width: 100%;
            padding: 10px 16px;
            text-align: left;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            transition: background 0.2s;
        }

        .dropdown-item:hover {
            background: rgba(57, 255, 20, 0.1);
        }

        /* Event Participation */
        .event-card {
            transition: all 0.3s ease;
        }

        .event-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(57, 255, 20, 0.2);
        }

        .participating {
            background: rgba(57, 255, 20, 0.1);
            border-color: #39FF14;
        }
    </style>
</head>
<body class="bg-dark-base min-h-screen">
    <!-- Toast Notifications -->
    <div id="toastContainer"></div>

    <!-- Cabe√ßalho -->
    <header class="sticky top-0 z-50 bg-dark-base border-b border-neon-green">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-dragon text-neon-green text-2xl"></i>
                <h1 class="text-2xl font-bold text-neon-green">Guild Origem</h1>
            </div>
            
            <div class="hidden md:flex space-x-6">
                <a href="#inicio" class="text-white hover:text-neon-green transition">In√≠cio</a>
                <a href="#membros" class="text-white hover:text-neon-green transition">Membros</a>
                <a href="#sobre" class="text-white hover:text-neon-green transition">Sobre</a>
                <a href="#eventos" class="text-white hover:text-neon-green transition">Eventos</a>
                <a href="#regras" class="text-white hover:text-neon-green transition">Regras</a>
            </div>
            
            <div class="flex items-center space-x-4">
                <!-- Usu√°rio Logado -->
                <div id="userMenu" class="hidden flex items-center space-x-3">
                    <div class="text-right">
                        <p class="text-sm text-neon-green">Ol√°, <span id="userGreeting">Membro</span></p>
                        <p class="text-xs text-gray-400">Bem-vindo √† Guild</p>
                    </div>
                    <div class="relative group">
                        <button id="userAvatar" class="w-10 h-10 rounded-full bg-neon-green text-dark-base flex items-center justify-center font-bold hover:bg-neon-green-hover transition">
                            <i class="fas fa-user"></i>
                        </button>
                        <!-- Dropdown Menu -->
                        <div class="dropdown-menu hidden group-hover:block">
                            <button id="viewProfileBtn" class="dropdown-item">
                                <i class="fas fa-user mr-2"></i>Meu Perfil
                            </button>
                            <button id="manageEventsBtn" class="dropdown-item admin-only hidden">
                                <i class="fas fa-calendar-plus mr-2"></i>Gerenciar Eventos
                            </button>
                            <hr class="border-gray-600 my-1">
                            <button id="logoutHeaderBtn" class="dropdown-item text-red-400">
                                <i class="fas fa-sign-out-alt mr-2"></i>Sair
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Usu√°rio N√£o Logado -->
                <div id="guestMenu">
                    <button id="loginBtn" class="px-4 py-2 neon-button rounded font-bold">Entrar</button>
                </div>
            </div>
        </div>
    </header>

    <!-- Conte√∫do Principal -->
    <main id="mainContent">
        <!-- Banner Principal -->
        <section id="inicio" class="relative py-16 md:py-24 bg-gradient-to-r from-dark-base to-gray-900">
            <div class="container mx-auto px-4 text-center">
                <h2 class="text-4xl md:text-6xl font-bold mb-4 text-neon-green">Guild Origem</h2>
                <p class="text-xl md:text-2xl mb-8">Comunidade de AdventureQuest Worlds</p>
                
                <div class="max-w-2xl mx-auto bg-dark-base p-6 rounded-lg neon-border mb-8">
                    <h3 class="text-2xl font-bold mb-4 text-neon-green">Status da Guild</h3>
                    <div class="flex justify-between mb-2">
                        <span>Membros Ativos</span>
                        <span id="activeMembers">58/140</span>
                    </div>
                    <div class="progress-bar mb-4">
                        <div class="progress-fill" style="width: 41.4%"></div>
                    </div>
                    <p class="text-sm text-gray-400">Precisamos de mais 82 membros para completar a guild!</p>
                </div>
                
                <button id="joinBtn" class="px-8 py-3 neon-button rounded-lg font-bold text-lg">Junte-se a N√≥s</button>
            </div>
        </section>

        <!-- Se√ß√£o de Membros -->
        <section id="membros" class="py-16">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center mb-12 text-neon-green">Nossos Membros</h2>
                
                <div id="membersGrid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                    <!-- Membros ser√£o carregados dinamicamente -->
                </div>
                
                <div class="text-center mt-8">
                    <button class="px-6 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition">Ver Todos os Membros</button>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o Sobre a Guild -->
        <section id="sobre" class="py-16 bg-gray-900">
            <div class="container mx-auto px-4">
                <div class="max-w-3xl mx-auto text-center">
                    <h2 class="text-3xl font-bold mb-6 text-neon-green">Sobre a Guild Origem</h2>
                    <p class="text-lg mb-6">
                        A Guild Origem √© uma comunidade dedicada de jogadores de AdventureQuest Worlds, focada em criar um ambiente amig√°vel e colaborativo para todos os membros. Nossa miss√£o √© crescer juntos, superar desafios √©picos e construir amizades duradouras no mundo de Lore.
                    </p>
                    <p class="text-lg mb-8">
                        Com 58 membros ativos de um total de 140, estamos sempre em busca de novos aventureiros para se juntar √† nossa fam√≠lia. Oferecemos eventos semanais, ajuda com quests dif√≠ceis e um sistema de ranking que recompensa a atividade e contribui√ß√£o.
                    </p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-10">
                        <div class="bg-dark-base p-6 rounded-lg neon-border">
                            <i class="fas fa-users text-neon-green text-3xl mb-4"></i>
                            <h3 class="text-xl font-bold mb-2">Comunidade Ativa</h3>
                            <p>Eventos semanais e chat sempre movimentado</p>
                        </div>
                        
                        <div class="bg-dark-base p-6 rounded-lg neon-border">
                            <i class="fas fa-trophy text-neon-green text-3xl mb-4"></i>
                            <h3 class="text-xl font-bold mb-2">Sistema de Ranking</h3>
                            <p>Progress√£o baseada em atividade e contribui√ß√£o</p>
                        </div>
                        
                        <div class="bg-dark-base p-6 rounded-lg neon-border">
                            <i class="fas fa-shield-alt text-neon-green text-3xl mb-4"></i>
                            <h3 class="text-xl font-bold mb-2">Ajuda em Quests</h3>
                            <p>Suporte para quests dif√≠ceis e bosses desafiadores</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o de Eventos -->
        <section id="eventos" class="py-16">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center mb-12 text-neon-green">Pr√≥ximos Eventos</h2>
                
                <div id="eventsList" class="max-w-4xl mx-auto space-y-6">
                    <!-- Eventos ser√£o carregados dinamicamente -->
                </div>

                <!-- Bot√£o para Administradores -->
                <div id="adminEventControls" class="text-center mt-8 hidden">
                    <button id="addEventBtn" class="px-6 py-3 neon-button rounded-lg font-bold">
                        <i class="fas fa-plus mr-2"></i>Adicionar Evento
                    </button>
                </div>
            </div>
        </section>

        <!-- Se√ß√£o de Regras -->
        <section id="regras" class="py-16 bg-gray-900">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center mb-12 text-neon-green">Regras da Guild</h2>
                
                <div class="max-w-3xl mx-auto bg-dark-base p-6 rounded-lg neon-border">
                    <ol class="list-decimal pl-5 space-y-4">
                        <li class="pb-2 border-b border-gray-700">Respeite todos os membros da guild e da comunidade de AQW.</li>
                        <li class="pb-2 border-b border-gray-700">N√£o utilize linguagem ofensiva, discriminat√≥ria ou t√≥xica.</li>
                        <li class="pb-2 border-b border-gray-700">Participe ativamente dos eventos da guild sempre que poss√≠vel.</li>
                        <li class="pb-2 border-b border-gray-700">Ajude outros membros quando solicitado, especialmente os novatos.</li>
                        <li class="pb-2 border-b border-gray-700">N√£o divulgue informa√ß√µes privadas da guild para jogadores externos.</li>
                        <li class="pb-2 border-b border-gray-700">Mantenha-se ativo - inatividade prolongada pode resultar em remo√ß√£o.</li>
                        <li class="pb-2">Siga as regras oficiais do AdventureQuest Worlds em todos os momentos.</li>
                    </ol>
                </div>
            </div>
        </section>
    </main>

    <!-- Painel do Usu√°rio (Inicialmente Oculto) -->
    <section id="userPanel" class="user-panel py-16 hidden">
        <div class="container mx-auto px-4">
            <div class="max-w-6xl mx-auto">
                <!-- Cabe√ßalho do Perfil -->
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-3xl font-bold text-neon-green">Meu Perfil</h2>
                    <button id="backToMain" class="px-4 py-2 bg-gray-700 text-white rounded font-bold hover:bg-gray-600 transition">
                        <i class="fas fa-arrow-left mr-2"></i> Voltar ao Site
                    </button>
                </div>
                
                <!-- Perfil do Usu√°rio -->
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Card Principal do Perfil -->
                    <div class="bg-dark-base p-6 rounded-lg neon-border lg:col-span-3">
                        <div class="flex flex-col md:flex-row gap-6 items-start">
                            <!-- Foto de Perfil -->
                            <div class="flex-shrink-0 text-center">
                                <div class="relative inline-block">
                                    <img id="userPhoto" src="/default-avatar.png" alt="Foto de perfil" 
                                         class="w-32 h-32 rounded-full object-cover border-4 border-neon-green">
                                    <button id="changePhotoBtn" class="absolute bottom-0 right-0 bg-neon-green text-dark-base rounded-full p-2 hover:bg-neon-green-hover transition">
                                        <i class="fas fa-camera"></i>
                                    </button>
                                </div>
                                <input type="file" id="photoUpload" class="hidden" accept="image/*">
                                <h3 id="userDisplayName" class="text-xl font-bold mt-4 text-neon-green">Carregando...</h3>
                                <p id="userRankBadge" class="text-sm bg-neon-green text-dark-base px-3 py-1 rounded-full mt-2 inline-block">Novato</p>
                            </div>
                            
                            <!-- Informa√ß√µes do Perfil -->
                            <div class="flex-1">
                                <div class="mb-6">
                                    <h4 class="text-lg font-bold mb-3 text-neon-green">Sobre Mim</h4>
                                    <textarea id="userDescription" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" rows="3" placeholder="Conte um pouco sobre voc√™..."></textarea>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-gray-400 text-sm mb-1">Personagem Principal</label>
                                        <input type="text" id="userCharacter" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-gray-400 text-sm mb-1">N√≠vel</label>
                                        <input type="number" id="userLevel" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" min="1" max="100">
                                    </div>
                                    <div>
                                        <label class="block text-gray-400 text-sm mb-1">Classe Favorita</label>
                                        <input type="text" id="userClass" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none">
                                    </div>
                                    <div>
                                        <label class="block text-gray-400 text-sm mb-1">Tempo de Jogo</label>
                                        <input type="text" id="userPlaytime" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none">
                                    </div>
                                </div>

                                <button id="saveProfileBtn" class="w-full mt-6 px-6 py-3 neon-button rounded font-bold">
                                    <i class="fas fa-save mr-2"></i> Salvar Altera√ß√µes
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Status na Guild -->
                    <div class="bg-dark-base p-6 rounded-lg neon-border">
                        <h3 class="text-xl font-bold mb-4 text-neon-green">Status na Guild</h3>
                        <div class="space-y-4">
                            <div>
                                <p class="text-gray-400">Membro desde</p>
                                <p id="userJoinDate" class="text-lg font-bold">-</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Rank Atual</p>
                                <p id="userRank" class="text-lg font-bold text-neon-green">Novato</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Participa√ß√£o</p>
                                <div class="progress-bar mt-1">
                                    <div id="eventProgress" class="progress-fill" style="width: 65%"></div>
                                </div>
                                <p class="text-sm text-gray-400 mt-1">13/20 eventos</p>
                            </div>
                            <div>
                                <p class="text-gray-400">Contribui√ß√£o</p>
                                <div class="progress-bar mt-1">
                                    <div id="contributionProgress" class="progress-fill" style="width: 40%"></div>
                                </div>
                                <p class="text-sm text-gray-400 mt-1">M√©dio</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Meus Eventos -->
                <div class="bg-dark-base p-6 rounded-lg neon-border">
                    <h3 class="text-xl font-bold mb-4 text-neon-green">Meus Eventos</h3>
                    <div id="myEventsList" class="space-y-3">
                        <!-- Eventos do usu√°rio ser√£o carregados aqui -->
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Modal de Login -->
    <div id="loginModal" class="fixed inset-0 z-50 flex items-center justify-center modal-overlay hidden">
        <div class="bg-dark-base rounded-lg p-8 w-full max-w-md neon-border relative">
            <button id="closeLoginModal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <h2 class="text-2xl font-bold mb-6 text-center text-neon-green">Entrar na Guild</h2>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label for="loginEmail" class="block mb-2">E-mail</label>
                    <input type="email" id="loginEmail" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <div>
                    <label for="loginPassword" class="block mb-2">Senha</label>
                    <input type="password" id="loginPassword" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <button type="submit" class="w-full py-3 neon-button rounded font-bold mt-4">
                    <span id="loginBtnText">Entrar</span>
                    <div id="loginSpinner" class="spinner hidden"></div>
                </button>
                
                <div class="relative my-4">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-700"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-dark-base text-gray-400">Ou entre com</span>
                    </div>
                </div>
                
                <button type="button" id="googleLogin" class="google-login">
                    <svg class="google-icon" viewBox="0 0 24 24" width="18" height="18">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    <span id="googleBtnText">Continuar com Google</span>
                    <div id="googleSpinner" class="spinner hidden"></div>
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-400">N√£o tem uma conta? <button id="showRegister" class="text-neon-green hover:underline">Registre-se</button></p>
            </div>
        </div>
    </div>

    <!-- Modal de Registro -->
    <div id="registerModal" class="fixed inset-0 z-50 flex items-center justify-center modal-overlay hidden">
        <div class="bg-dark-base rounded-lg p-8 w-full max-w-md neon-border relative">
            <button id="closeRegisterModal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <h2 class="text-2xl font-bold mb-6 text-center text-neon-green">Junte-se √† Guild</h2>
            
            <form id="registerForm" class="space-y-4">
                <div>
                    <label for="registerUsername" class="block mb-2">Nome do personagem</label>
                    <input type="text" id="registerUsername" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <div>
                    <label for="registerEmail" class="block mb-2">E-mail</label>
                    <input type="email" id="registerEmail" placeholder="Qual seu melhor email?" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <div>
                    <label for="registerPassword" class="block mb-2">Senha</label>
                    <input type="password" id="registerPassword" placeholder="Crie sua senha" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <div>
                    <label for="registerConfirmPassword" class="block mb-2">Confirmar Senha</label>
                    <input type="password" id="registerConfirmPassword" placeholder="Confirme sua senha" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>

                <div>
                    <label for="registerLevel" class="block mb-2">N√≠vel</label>
                    <input type="number" id="registerLevel" placeholder="Digite seu n√≠vel no jogo" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" min="1" max="100" required>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="acceptRules" class="mr-2" required>
                    <label for="acceptRules">Eu li e aceito as <a href="#regras" class="text-neon-green hover:underline">regras da guild</a></label>
                </div>
                
                <button type="submit" class="w-full py-3 neon-button rounded font-bold mt-4">
                    <span id="registerBtnText">Registrar</span>
                    <div id="registerSpinner" class="spinner hidden"></div>
                </button>
            </form>
            
            <div class="mt-6 text-center">
                <p class="text-gray-400">J√° tem uma conta? <button id="showLogin" class="text-neon-green hover:underline">Fa√ßa login</button></p>
            </div>
        </div>
    </div>

    <!-- Modal de Adicionar Evento (Admin) -->
    <div id="addEventModal" class="fixed inset-0 z-50 flex items-center justify-center modal-overlay hidden">
        <div class="bg-dark-base rounded-lg p-8 w-full max-w-md neon-border relative">
            <button id="closeAddEventModal" class="absolute top-4 right-4 text-gray-400 hover:text-white">
                <i class="fas fa-times text-xl"></i>
            </button>
            
            <h2 class="text-2xl font-bold mb-6 text-center text-neon-green">Adicionar Evento</h2>
            
            <form id="addEventForm" class="space-y-4">
                <div>
                    <label for="eventTitle" class="block mb-2">T√≠tulo do Evento</label>
                    <input type="text" id="eventTitle" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                </div>
                
                <div>
                    <label for="eventDescription" class="block mb-2">Descri√ß√£o</label>
                    <textarea id="eventDescription" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" rows="3" required></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="eventDate" class="block mb-2">Data</label>
                        <input type="date" id="eventDate" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                    </div>
                    
                    <div>
                        <label for="eventTime" class="block mb-2">Hor√°rio</label>
                        <input type="time" id="eventTime" class="w-full p-3 bg-gray-800 rounded border border-gray-700 focus:border-neon-green focus:outline-none" required>
                    </div>
                </div>
                
                <button type="submit" class="w-full py-3 neon-button rounded font-bold mt-4">
                    <i class="fas fa-plus mr-2"></i>Adicionar Evento
                </button>
            </form>
        </div>
    </div>

    <!-- Rodap√© -->
    <footer class="py-8 border-t border-gray-800">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-dragon text-neon-green text-2xl"></i>
                        <h2 class="text-xl font-bold text-neon-green">Guild Origem</h2>
                    </div>
                    <p class="text-sm text-gray-400 mt-2">Comunidade de AdventureQuest Worlds</p>
                </div>
                
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-neon-green transition">
                        <i class="fab fa-discord text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-neon-green transition">
                        <i class="fab fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-neon-green transition">
                        <i class="fab fa-youtube text-xl"></i>
                    </a>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-6 pt-6 text-center text-gray-400 text-sm">
                <p id="copyright">&copy; 2023 Guild Origem. Todos os direitos reservados. AdventureQuest Worlds √© uma marca registrada da Artix Entertainment.</p>
            </div>
        </div>
    </footer>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword, 
    onAuthStateChanged, 
    GoogleAuthProvider, 
    signInWithPopup, 
    signOut,
    updateProfile
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
  import { 
    getFirestore, 
    doc,
    setDoc,
    getDoc,
    updateDoc,
    collection,
    addDoc,
    getDocs,
    query,
    where,
    onSnapshot,
    deleteDoc
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";
  import { 
    getStorage, 
    ref, 
    uploadBytes, 
    getDownloadURL 
  } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-storage.js";

  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyA3_9b12m998SElovquIpmJASDnF8G6bE8",
    authDomain: "tipgabrieldev-cf200.firebaseapp.com",
    projectId: "tipgabrieldev-cf200",
    storageBucket: "tipgabrieldev-cf200.firebasestorage.app",
    messagingSenderId: "110047072655",
    appId: "1:110047072655:web:cce5ff2c319d7cab087bfa"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);
  
  // CONFIGURA√á√ÉO CORRIGIDA DO GOOGLE PROVIDER
  const googleProvider = new GoogleAuthProvider();
  googleProvider.setCustomParameters({
    prompt: 'select_account',
    display: 'popup',
    login_hint: ''
  });
  
  // Configurar auth para usar o dom√≠nio atual
  auth.useDeviceLanguage();
  
  console.log("‚úÖ Firebase configurado para:", window.location.hostname);

  // IDs dos administradores (adicione seu UID aqui)
  const ADMIN_UIDS = [
    'seu-uid-aqui', // Substitua pelo seu UID do Firebase
    'outro-admin-uid'
  ];

  // Fun√ß√£o para mostrar toast
  function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.className = `toast ${type}`;
    toast.textContent = message;
    
    document.getElementById('toastContainer').appendChild(toast);
    
    setTimeout(() => toast.classList.add('show'), 100);
    
    setTimeout(() => {
      toast.classList.remove('show');
      setTimeout(() => toast.remove(), 300);
    }, 4000);
  }

  // Verificar se usu√°rio √© admin
  function isAdmin(user) {
    return ADMIN_UIDS.includes(user.uid);
  }

  // Fun√ß√µes de autentica√ß√£o melhoradas
  window.registerUser = async (email, password, username, level) => {
    try {
      showToast('Criando sua conta...', 'info');
      
      const userCredential = await createUserWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      // Atualizar perfil do usu√°rio
      await updateProfile(user, {
        displayName: username
      });
      
      // Salvar informa√ß√µes na cole√ß√£o guild_origem_users
      await setDoc(doc(db, "guild_origem_users", user.uid), {
        uid: user.uid,
        username: username,
        email: email,
        character: username,
        level: parseInt(level),
        description: `Um novo aventureiro chegou √† Guild Origem! üéÆ`,
        favoriteClass: "A descobrir",
        playtime: "Rec√©m-chegado",
        joinDate: new Date(),
        rank: "Novato",
        guild: "Guild Origem",
        site: "guildorigem.vercel.app",
        isAdmin: isAdmin(user),
        timestamp: new Date()
      });
      
      showToast('üéâ Conta criada com sucesso! Bem-vindo √† Guild Origem!', 'success');
      return user;
    } catch (error) {
      console.error("‚ùå Erro no registro:", error);
      let errorMessage = "Erro ao criar conta: ";
      
      switch(error.code) {
        case 'auth/email-already-in-use':
          errorMessage = "Este email j√° est√° em uso.";
          break;
        case 'auth/weak-password':
          errorMessage = "A senha √© muito fraca. Use pelo menos 6 caracteres.";
          break;
        case 'auth/invalid-email':
          errorMessage = "O email informado √© inv√°lido.";
          break;
        default:
          errorMessage = error.message;
      }
      
      showToast(errorMessage, 'error');
      throw error;
    }
  };

  window.loginUser = async (email, password) => {
    try {
      showToast('Fazendo login...', 'info');
      
      const userCredential = await signInWithEmailAndPassword(auth, email, password);
      const user = userCredential.user;
      
      showToast('‚úÖ Login realizado com sucesso!', 'success');
      return user;
    } catch (error) {
      console.error("‚ùå Erro no login:", error);
      let errorMessage = "Erro ao fazer login: ";
      
      switch(error.code) {
        case 'auth/user-not-found':
          errorMessage = "Usu√°rio n√£o encontrado.";
          break;
        case 'auth/wrong-password':
          errorMessage = "Senha incorreta.";
          break;
        case 'auth/invalid-email':
          errorMessage = "Email inv√°lido.";
          break;
        default:
          errorMessage = error.message;
      }
      
      showToast(errorMessage, 'error');
      throw error;
    }
  };

  // Fun√ß√£o de login com Google CORRIGIDA
  window.loginWithGoogle = async () => {
    try {
      console.log("üîê Iniciando login Google...");
      showToast('Abrindo autentica√ß√£o do Google...', 'info');
      
      const result = await signInWithPopup(auth, googleProvider);
      const user = result.user;
      
      console.log("‚úÖ Login Google realizado com sucesso!");

      // Verificar se o usu√°rio j√° existe
      const userDoc = await getDoc(doc(db, "guild_origem_users", user.uid));
      
      if (!userDoc.exists()) {
        await setDoc(doc(db, "guild_origem_users", user.uid), {
          uid: user.uid,
          username: user.displayName || user.email.split('@')[0],
          email: user.email,
          character: user.displayName || "A definir",
          level: 1,
          description: `Um novo aventureiro chegou √† Guild Origem! üéÆ`,
          favoriteClass: "A descobrir",
          playtime: "Rec√©m-chegado",
          joinDate: new Date(),
          rank: "Novato",
          guild: "Guild Origem",
          site: "guildorigem.vercel.app",
          provider: "google",
          photoURL: user.photoURL || "",
          isAdmin: isAdmin(user),
          timestamp: new Date()
        });
        console.log("üìù Novo usu√°rio criado no Firestore");
        showToast('üéâ Perfil criado! Bem-vindo √† Guild Origem!', 'success');
      } else {
        showToast('‚úÖ Login realizado! Bem-vindo de volta!', 'success');
      }
      
      return user;
    } catch (error) {
      console.error("‚ùå Erro no login Google:", error);
      
      if (error.code === 'auth/popup-closed-by-user') {
        showToast('Login com Google cancelado.', 'info');
      } else if (error.code === 'auth/popup-blocked') {
        showToast('Popup bloqueado! Permita popups para este site.', 'error');
      } else {
        showToast('Erro no login: ' + error.message, 'error');
      }
      throw error;
    }
  };

  // Fun√ß√£o para atualizar perfil
  window.updateUserProfile = async (userData) => {
    try {
      const user = auth.currentUser;
      if (!user) throw new Error('Usu√°rio n√£o autenticado');

      // Atualizar no Firestore
      await updateDoc(doc(db, "guild_origem_users", user.uid), userData);
      
      // Atualizar no Auth se necess√°rio
      if (userData.username && userData.username !== user.displayName) {
        await updateProfile(user, {
          displayName: userData.username
        });
      }
      
      showToast('Perfil atualizado com sucesso!', 'success');
      return true;
    } catch (error) {
      console.error('Erro ao atualizar perfil:', error);
      showToast('Erro ao atualizar perfil: ' + error.message, 'error');
      throw error;
    }
  };

  // Fun√ß√£o para upload de foto
  window.uploadProfilePhoto = async (file) => {
    try {
      const user = auth.currentUser;
      if (!user) throw new Error('Usu√°rio n√£o autenticado');

      // Criar refer√™ncia no storage
      const storageRef = ref(storage, `profile_photos/${user.uid}`);
      
      // Fazer upload
      const snapshot = await uploadBytes(storageRef, file);
      const downloadURL = await getDownloadURL(snapshot.ref);
      
      // Atualizar foto no Auth
      await updateProfile(user, {
        photoURL: downloadURL
      });
      
      // Atualizar no Firestore
      await updateDoc(doc(db, "guild_origem_users", user.uid), {
        photoURL: downloadURL
      });
      
      showToast('Foto de perfil atualizada!', 'success');
      return downloadURL;
    } catch (error) {
      console.error('Erro ao fazer upload da foto:', error);
      showToast('Erro ao atualizar foto: ' + error.message, 'error');
      throw error;
    }
  };

  // Fun√ß√£o para adicionar evento
  window.addEvent = async (eventData) => {
    try {
      const user = auth.currentUser;
      if (!user) throw new Error('Usu√°rio n√£o autenticado');
      
      if (!isAdmin(user)) {
        throw new Error('Apenas administradores podem adicionar eventos');
      }

      const eventWithMetadata = {
        ...eventData,
        createdBy: user.uid,
        createdAt: new Date(),
        participants: []
      };

      const docRef = await addDoc(collection(db, "guild_events"), eventWithMetadata);
      showToast('Evento adicionado com sucesso!', 'success');
      return docRef.id;
    } catch (error) {
      console.error('Erro ao adicionar evento:', error);
      showToast('Erro ao adicionar evento: ' + error.message, 'error');
      throw error;
    }
  };

  // Fun√ß√£o para participar de evento
  window.toggleEventParticipation = async (eventId, participating) => {
    try {
      const user = auth.currentUser;
      if (!user) throw new Error('Usu√°rio n√£o autenticado');

      const eventRef = doc(db, "guild_events", eventId);
      const eventDoc = await getDoc(eventRef);
      
      if (!eventDoc.exists()) {
        throw new Error('Evento n√£o encontrado');
      }

      const eventData = eventDoc.data();
      let participants = eventData.participants || [];

      if (participating) {
        // Remover participa√ß√£o
        participants = participants.filter(uid => uid !== user.uid);
      } else {
        // Adicionar participa√ß√£o
        if (!participants.includes(user.uid)) {
          participants.push(user.uid);
        }
      }

      await updateDoc(eventRef, { participants });
      
      const action = participating ? 'removida' : 'confirmada';
      showToast(`Participa√ß√£o ${action} com sucesso!`, 'success');
      return true;
    } catch (error) {
      console.error('Erro ao atualizar participa√ß√£o:', error);
      showToast('Erro ao atualizar participa√ß√£o: ' + error.message, 'error');
      throw error;
    }
  };

  // Carregar eventos
  window.loadEvents = async () => {
    try {
      const eventsQuery = query(collection(db, "guild_events"));
      const querySnapshot = await getDocs(eventsQuery);
      const events = [];
      
      querySnapshot.forEach((doc) => {
        events.push({ id: doc.id, ...doc.data() });
      });
      
      return events.sort((a, b) => new Date(a.date) - new Date(b.date));
    } catch (error) {
      console.error('Erro ao carregar eventos:', error);
      return [];
    }
  };

  // Carregar membros
  window.loadMembers = async () => {
    try {
      const membersQuery = query(collection(db, "guild_origem_users"));
      const querySnapshot = await getDocs(membersQuery);
      const members = [];
      
      querySnapshot.forEach((doc) => {
        members.push(doc.data());
      });
      
      return members;
    } catch (error) {
      console.error('Erro ao carregar membros:', error);
      return [];
    }
  };

  // Verificar estado de autentica√ß√£o - VERS√ÉO MELHORADA
  onAuthStateChanged(auth, async (user) => {
    if (user) {
      console.log("üë§ Usu√°rio logado:", user.email);
      
      // Atualizar interface do usu√°rio
      document.getElementById('guestMenu').classList.add('hidden');
      document.getElementById('userMenu').classList.remove('hidden');
      document.getElementById('userGreeting').textContent = user.displayName || 'Membro';
      
      try {
        // Carregar informa√ß√µes do usu√°rio
        const userDoc = await getDoc(doc(db, "guild_origem_users", user.uid));
        
        if (userDoc.exists()) {
          const userData = userDoc.data();
          console.log("üìä Dados do usu√°rio:", userData);
          
          // Verificar se √© admin
          if (isAdmin(user)) {
            document.querySelectorAll('.admin-only').forEach(el => {
              el.classList.remove('hidden');
            });
          }
          
          // Preencher painel do usu√°rio se estiver vis√≠vel
          if (document.getElementById('userPanel').classList.contains('hidden') === false) {
            const userPhoto = userData.photoURL || user.photoURL || 'https://via.placeholder.com/150/171717/39FF14?text=GUILD';
            document.getElementById('userPhoto').src = userPhoto;
            document.getElementById('userDisplayName').textContent = userData.username || user.displayName || "Membro da Guild";
            document.getElementById('userDescription').value = userData.description || "Um membro dedicado da Guild Origem, sempre pronto para aventuras √©picas!";
            document.getElementById('userCharacter').value = userData.character || userData.username || "A definir";
            document.getElementById('userLevel').value = userData.level || 1;
            document.getElementById('userClass').value = userData.favoriteClass || "A definir";
            document.getElementById('userPlaytime').value = userData.playtime || "Rec√©m-chegado";
            document.getElementById('userRank').textContent = userData.rank || "Novato";
            document.getElementById('userRankBadge').textContent = userData.rank || "Novato";
            
            // Data de entrada
            if (userData.joinDate) {
              const joinDate = userData.joinDate.toDate ? userData.joinDate.toDate() : new Date(userData.joinDate);
              document.getElementById('userJoinDate').textContent = joinDate.toLocaleDateString('pt-BR');
            } else {
              document.getElementById('userJoinDate').textContent = new Date().toLocaleDateString('pt-BR');
            }
          }
        }
      } catch (error) {
        console.error("‚ùå Erro ao carregar dados do usu√°rio:", error);
      }
    } else {
      console.log("üö™ Usu√°rio n√£o logado");
      document.getElementById('guestMenu').classList.remove('hidden');
      document.getElementById('userMenu').classList.add('hidden');
      document.getElementById('mainContent').classList.remove('hidden');
      document.getElementById('userPanel').classList.add('hidden');
    }
  });

  // Fun√ß√£o de logout
  window.logoutUser = async () => {
    try {
      await signOut(auth);
      // N√£o mostrar mensagem de toast no logout
      document.getElementById('mainContent').classList.remove('hidden');
      document.getElementById('userPanel').classList.add('hidden');
    } catch (error) {
      console.error("‚ùå Erro no logout:", error);
    }
  };
</script>

<!-- JavaScript para funcionalidades da interface -->
<script>
  // Elementos DOM
  const loginBtn = document.getElementById('loginBtn');
  const logoutHeaderBtn = document.getElementById('logoutHeaderBtn');
  const joinBtn = document.getElementById('joinBtn');
  const loginModal = document.getElementById('loginModal');
  const registerModal = document.getElementById('registerModal');
  const addEventModal = document.getElementById('addEventModal');
  const closeLoginModalBtn = document.getElementById('closeLoginModal');
  const closeRegisterModalBtn = document.getElementById('closeRegisterModal');
  const closeAddEventModalBtn = document.getElementById('closeAddEventModal');
  const showRegister = document.getElementById('showRegister');
  const showLogin = document.getElementById('showLogin');
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  const addEventForm = document.getElementById('addEventForm');
  const googleLoginBtn = document.getElementById('googleLogin');
  const mainContent = document.getElementById('mainContent');
  const userPanel = document.getElementById('userPanel');
  const backToMainBtn = document.getElementById('backToMain');
  const saveProfileBtn = document.getElementById('saveProfileBtn');
  const changePhotoBtn = document.getElementById('changePhotoBtn');
  const photoUpload = document.getElementById('photoUpload');
  const viewProfileBtn = document.getElementById('viewProfileBtn');
  const manageEventsBtn = document.getElementById('manageEventsBtn');
  const addEventBtn = document.getElementById('addEventBtn');
  const membersGrid = document.getElementById('membersGrid');
  const eventsList = document.getElementById('eventsList');
  const myEventsList = document.getElementById('myEventsList');
  const adminEventControls = document.getElementById('adminEventControls');

  // Fun√ß√µes para mostrar/ocultar loading
  function showLoading(buttonId, spinnerId, textId) {
    document.getElementById(buttonId).disabled = true;
    document.getElementById(spinnerId).classList.remove('hidden');
    document.getElementById(textId).style.opacity = '0.5';
  }

  function hideLoading(buttonId, spinnerId, textId) {
    document.getElementById(buttonId).disabled = false;
    document.getElementById(spinnerId).classList.add('hidden');
    document.getElementById(textId).style.opacity = '1';
  }

  // Fun√ß√µes para fechar modais
  function closeLoginModal() {
    loginModal.classList.add('hidden');
    loginForm.reset();
  }

  function closeRegisterModal() {
    registerModal.classList.add('hidden');
    registerForm.reset();
  }

  function closeAddEventModal() {
    addEventModal.classList.add('hidden');
    addEventForm.reset();
  }

  // Abrir modal de login
  loginBtn.addEventListener('click', () => {
    loginModal.classList.remove('hidden');
  });

  // Logout do header
  logoutHeaderBtn.addEventListener('click', () => {
    window.logoutUser();
  });

  // Abrir modal de registro
  joinBtn.addEventListener('click', () => {
    registerModal.classList.remove('hidden');
  });

  // Fechar modais
  closeLoginModalBtn.addEventListener('click', closeLoginModal);
  closeRegisterModalBtn.addEventListener('click', closeRegisterModal);
  closeAddEventModalBtn.addEventListener('click', closeAddEventModal);

  // Alternar entre login e registro
  showRegister.addEventListener('click', () => {
    closeLoginModal();
    registerModal.classList.remove('hidden');
  });

  showLogin.addEventListener('click', () => {
    closeRegisterModal();
    loginModal.classList.remove('hidden');
  });

  // Fechar modais ao clicar fora
  window.addEventListener('click', (e) => {
    if (e.target === loginModal) closeLoginModal();
    if (e.target === registerModal) closeRegisterModal();
    if (e.target === addEventModal) closeAddEventModal();
  });

  // Processar formul√°rio de login
  loginForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    
    showLoading('loginForm', 'loginSpinner', 'loginBtnText');
    
    try {
      await window.loginUser(email, password);
      closeLoginModal();
    } catch (error) {
      // Erro j√° tratado na fun√ß√£o
    } finally {
      hideLoading('loginForm', 'loginSpinner', 'loginBtnText');
    }
  });

  // Processar formul√°rio de registro
  registerForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    const username = document.getElementById('registerUsername').value;
    const level = document.getElementById('registerLevel').value;
    const confirmPassword = document.getElementById('registerConfirmPassword').value;
    
    showLoading('registerForm', 'registerSpinner', 'registerBtnText');
    
    try {
      if (password !== confirmPassword) {
        throw new Error('As senhas n√£o coincidem!');
      }
      
      if (!document.getElementById('acceptRules').checked) {
        throw new Error('Voc√™ precisa aceitar as regras da guild!');
      }

      await window.registerUser(email, password, username, level);
      closeRegisterModal();
    } catch (error) {
      // Erro j√° tratado na fun√ß√£o
    } finally {
      hideLoading('registerForm', 'registerSpinner', 'registerBtnText');
    }
  });

  // Login com Google - VERS√ÉO CORRIGIDA
  googleLoginBtn.addEventListener('click', async () => {
    showLoading('googleLogin', 'googleSpinner', 'googleBtnText');
    
    try {
      await window.loginWithGoogle();
      closeLoginModal();
    } catch (error) {
      // Erro j√° tratado na fun√ß√£o
    } finally {
      hideLoading('googleLogin', 'googleSpinner', 'googleBtnText');
    }
  });

  // Voltar ao site principal
  backToMainBtn.addEventListener('click', () => {
    userPanel.classList.add('hidden');
    mainContent.classList.remove('hidden');
  });

  // Ver perfil
  viewProfileBtn.addEventListener('click', () => {
    mainContent.classList.add('hidden');
    userPanel.classList.remove('hidden');
    loadUserProfileData();
  });

  // Gerenciar eventos (admin)
  manageEventsBtn.addEventListener('click', () => {
    addEventModal.classList.remove('hidden');
  });

  // Adicionar evento
  addEventBtn.addEventListener('click', () => {
    addEventModal.classList.remove('hidden');
  });

  // Processar formul√°rio de adicionar evento
  addEventForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const title = document.getElementById('eventTitle').value;
    const description = document.getElementById('eventDescription').value;
    const date = document.getElementById('eventDate').value;
    const time = document.getElementById('eventTime').value;
    
    try {
      await window.addEvent({
        title,
        description,
        date,
        time,
        datetime: new Date(`${date}T${time}`)
      });
      closeAddEventModal();
      loadEvents();
    } catch (error) {
      // Erro j√° tratado na fun√ß√£o
    }
  });

  // Salvar perfil
  saveProfileBtn.addEventListener('click', async () => {
    const userData = {
      username: document.getElementById('userDisplayName').textContent,
      character: document.getElementById('userCharacter').value,
      level: parseInt(document.getElementById('userLevel').value),
      description: document.getElementById('userDescription').value,
      favoriteClass: document.getElementById('userClass').value,
      playtime: document.getElementById('userPlaytime').value
    };
    
    try {
      await window.updateUserProfile(userData);
    } catch (error) {
      // Erro j√° tratado na fun√ß√£o
    }
  });

  // Upload de foto
  changePhotoBtn.addEventListener('click', () => {
    photoUpload.click();
  });

  photoUpload.addEventListener('change', async (e) => {
    const file = e.target.files[0];
    if (file) {
      try {
        const imageUrl = await window.uploadProfilePhoto(file);
        document.getElementById('userPhoto').src = imageUrl;
      } catch (error) {
        // Erro j√° tratado na fun√ß√£o
      }
    }
  });

  // Carregar dados do perfil do usu√°rio
  async function loadUserProfileData() {
    try {
      const user = await new Promise((resolve) => {
        const auth = getAuth();
        onAuthStateChanged(auth, (user) => resolve(user));
      });
      
      if (user) {
        const userDoc = await getDoc(doc(getFirestore(), "guild_origem_users", user.uid));
        if (userDoc.exists()) {
          const userData = userDoc.data();
          
          // Preencher formul√°rio do perfil
          document.getElementById('userPhoto').src = userData.photoURL || user.photoURL || 'https://via.placeholder.com/150/171717/39FF14?text=GUILD';
          document.getElementById('userDisplayName').textContent = userData.username || user.displayName || "Membro da Guild";
          document.getElementById('userDescription').value = userData.description || "Um membro dedicado da Guild Origem, sempre pronto para aventuras √©picas!";
          document.getElementById('userCharacter').value = userData.character || userData.username || "A definir";
          document.getElementById('userLevel').value = userData.level || 1;
          document.getElementById('userClass').value = userData.favoriteClass || "A definir";
          document.getElementById('userPlaytime').value = userData.playtime || "Rec√©m-chegado";
          document.getElementById('userRank').textContent = userData.rank || "Novato";
          document.getElementById('userRankBadge').textContent = userData.rank || "Novato";
          
          if (userData.joinDate) {
            const joinDate = userData.joinDate.toDate ? userData.joinDate.toDate() : new Date(userData.joinDate);
            document.getElementById('userJoinDate').textContent = joinDate.toLocaleDateString('pt-BR');
          }
        }
      }
    } catch (error) {
      console.error('Erro ao carregar perfil:', error);
    }
  }

  // Carregar membros
  async function loadMembers() {
    try {
      const members = await window.loadMembers();
      membersGrid.innerHTML = '';
      
      members.forEach(member => {
        const memberCard = `
          <div class="member-card rounded-lg p-4 neon-border">
            <div class="flex items-center mb-4">
              <div class="w-16 h-16 rounded-full bg-gray-700 flex items-center justify-center mr-4 overflow-hidden">
                ${member.photoURL ? 
                  `<img src="${member.photoURL}" alt="${member.username}" class="w-full h-full object-cover">` : 
                  `<i class="fas fa-user text-neon-green text-xl"></i>`
                }
              </div>
              <div>
                <h3 class="font-bold text-lg">${member.username}</h3>
                <p class="text-sm text-gray-400">${member.rank || 'Membro'}</p>
              </div>
            </div>
            <div class="text-sm">
              <p class="mb-1"><i class="fas fa-shield-alt text-neon-green mr-2"></i> N√≠vel ${member.level || 1}</p>
              <p class="mb-1"><i class="fas fa-medal text-neon-green mr-2"></i> ${member.character || 'A definir'}</p>
              <p><i class="fas fa-clock text-neon-green mr-2"></i> ${member.playtime || 'Ativo'}</p>
            </div>
            <button class="view-profile-btn mt-3 w-full py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition" data-user-id="${member.uid}">
              Ver Perfil
            </button>
          </div>
        `;
        membersGrid.innerHTML += memberCard;
      });

      // Adicionar event listeners para os bot√µes de ver perfil
      document.querySelectorAll('.view-profile-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
          const userId = e.target.getAttribute('data-user-id');
          viewMemberProfile(userId);
        });
      });
    } catch (error) {
      console.error('Erro ao carregar membros:', error);
    }
  }

  // Carregar eventos
  async function loadEvents() {
    try {
      const events = await window.loadEvents();
      eventsList.innerHTML = '';
      
      events.forEach(event => {
        const eventDate = new Date(event.datetime);
        const now = new Date();
        const isPast = eventDate < now;
        
        const eventCard = `
          <div class="event-card bg-dark-base p-6 rounded-lg neon-border ${isPast ? 'opacity-60' : ''}">
            <div class="flex justify-between items-start mb-4">
              <div>
                <h3 class="text-xl font-bold text-neon-green">${event.title}</h3>
                <p class="text-gray-400">${eventDate.toLocaleDateString('pt-BR')} √†s ${eventDate.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}</p>
              </div>
              <span class="px-3 py-1 ${isPast ? 'bg-gray-600' : 'bg-neon-green'} text-dark-base rounded-full text-sm font-bold">
                ${isPast ? 'Realizado' : 'Em Breve'}
              </span>
            </div>
            <p class="text-gray-300 mb-4">${event.description}</p>
            <div class="flex justify-between items-center">
              <span class="text-sm text-gray-400">
                <i class="fas fa-users mr-1"></i>
                ${event.participants ? event.participants.length : 0} participantes
              </span>
              ${!isPast ? `
                <button class="participate-btn px-4 py-2 neon-button rounded font-bold text-sm" data-event-id="${event.id}">
                  Participar
                </button>
              ` : ''}
            </div>
          </div>
        `;
        eventsList.innerHTML += eventCard;
      });

      // Adicionar event listeners para os bot√µes de participar
      document.querySelectorAll('.participate-btn').forEach(btn => {
        btn.addEventListener('click', async (e) => {
          const eventId = e.target.getAttribute('data-event-id');
          const isParticipating = e.target.classList.contains('participating');
          
          try {
            await window.toggleEventParticipation(eventId, isParticipating);
            loadEvents(); // Recarregar eventos para atualizar a interface
          } catch (error) {
            // Erro j√° tratado na fun√ß√£o
          }
        });
      });
    } catch (error) {
      console.error('Erro ao carregar eventos:', error);
    }
  }

  // Limitar campo de n√≠vel
  const registerLevelInput = document.getElementById('registerLevel');
  if (registerLevelInput) {
    registerLevelInput.addEventListener('input', (e) => {
      e.target.value = e.target.value.replace(/\D/g, '');
      if (e.target.value.length > 3) {
        e.target.value = e.target.value.slice(0, 3);
      }
      const value = parseInt(e.target.value);
      if (value < 1) {
        e.target.value = 1;
      } else if (value > 100) {
        e.target.value = 100;
      }
    });
  }

  // Atualizar automaticamente o ano do copyright
  document.addEventListener('DOMContentLoaded', () => {
    const copyrightElement = document.getElementById('copyright');
    if (copyrightElement) {
      const currentYear = new Date().getFullYear();
      copyrightElement.textContent = copyrightElement.textContent.replace('2023', currentYear);
    }
    
    // Suavizar rolagem para √¢ncoras
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        
        const targetId = this.getAttribute('href');
        if (targetId === '#') return;
        
        const targetElement = document.querySelector(targetId);
        if (targetElement) {
          window.scrollTo({
            top: targetElement.offsetTop - 80,
            behavior: 'smooth'
          });
        }
      });
    });
    
    // Carregar dados iniciais
    loadMembers();
    loadEvents();
    
    console.log("‚úÖ Guild Origem carregado com todas as funcionalidades!");
  });
</script>
</body>
</html>
